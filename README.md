Thanks to Part Time Larry for allowing me to use some of his code.
